<html>
<header>
<title>Unemployment Rate of 2023 in India State</title>
</header>
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="nav.css" />
<script src="https://d3js.org/d3.v5.min.js"></script>
<style>
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

h1 { color: #fff; 
  font-size: 65px; font-weight: normal; 
  line-height: 60px; margin: 10px 0 0px 0; 
  text-transform: uppercase; text-shadow: 2px 2px 0 #000; 
  margin: 10px 0 24px; text-align: center; 
}


h2 { 
  font-family: 'Righteous', cursive; 
  font-size: 30px; letter-spacing: -1px; 
  color: #DFBF84; text-transform: uppercase; 
  text-shadow: 1px 1px 0 #000; margin: 10px 0 24px; 
  text-align: center; line-height: 50px; 
}


p { 
  color: #f6f6f6; font-family: 'Orienta', sans-serif; 
  font-size: 16px; line-height: 24px; margin: 10px 0 24px; 
  text-align: center; 
}

.active-state {
  fill: yellow !important; /* Override any other styles */
}


div.tooltip {	
    position: absolute;			
    text-align: center;			
    width: 150px;					
    height: 70px;					
    padding: 2px;
    font: 14px sans-serif;						
    background: #FFBF00;	
    border: 0px;			
    pointer-events: none;			
}

#map {
  width: 100%;
  box-shadow: 0 0 30px #111111;
  margin-top: 20px;
  float: left;
  background-color: #f0f0f0;
}

.left-clmn {
  width: 65%;
  float: left;
  padding-left: 10px;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
}

#right-clmn {
  width: 30%;
  float: left;
  
  padding-left: 50px;
}

.legend {
  transform: translate(100px, 30px);
}

.blegend {
  transform: translate(100px, 70px);
}

.filtered {
    fill-opacity: 1 !important;
}

#filter-buttons {
  display: flex;
  justify-content: center;
  margin: 15px 0; 
}

.btn {
  margin: 0 2px;
  padding: 10px 20px;
  cursor: pointer;
  border: 1px solid #CD5C5C;
  color: #293043;
  border-radius: 4px;
  background-color: #FFA07A; 
  transition: background-color 0.3s;
}

.btn:hover {
  background-color: #CD5C5C;
  color: #fff;
}

.searchb {
  padding: 5px 10px;
  cursor: pointer;
  border: 1px solid #CD5C5C;
  background-color: #FFA07A; 
}

.searchb:hover {
  background-color: #CD5C5C;
  color: #fff;
}

#percentageToCheck {
  padding: 5px 10px;
}

#maptext {
  display: inline-block;
  border-radius: 10px;
  padding: 10px;
}

#maptext.active {
  background-color: #FFBF00;
  border-radius: 10px;
  padding: 10px 30px;
}

.selectState {
  margin: 0 0 10px 0;
}

tr, td {
  text-align: left;
}

table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
  margin: auto;
}

td, th {
  border: 2px solid #E9967A;
  text-align: left;
  padding: 1.5px;
  font-size: 14px;
}

th {
  background-color: #CD5C5C;
  color: aliceblue;
}

tr {
    background-color: #fff4fd;
}

.Title {
  width: 100%;
  height: auto;
  margin-bottom: 20px;
  margin-top: 20px;
  text-align: center;
}

.info {
  width: 60%;
  height: auto;
  background-color: #922B21;
  margin: auto;
  padding: 100px 150px;
}

.back {
  width: 100%;
  height: auto; /* 100% of the viewport height */
  position: relative;
  background-repeat: no-repeat;
  background-size: cover;
  background-position: center;
  background-attachment: fixed; /* Fix the background image when scrolling */
  overflow: hidden; /* Hide overflow to prevent scrollbars */
  background-image: url(https://img.freepik.com/free-photo/unrecognizable-businesswoman-protesting-against-unemployment-holding-banner-with-need-work-inscription_637285-7223.jpg?w=996&t=st=1700161329~exp=1700161929~hmac=9dcd7d10ecb3629cb1fcbb2ccaa2a72726dd6da36f2b829428a40697fa5c5dc0);
}

.map-row {
  margin-top: 50px;
  width: 100%;
  height: 100%;
  margin-bottom: 50px;
  background-color: #f0f0f0b0; /* Choose your preferred background color */
  padding: 20px; /* Adjust padding as needed */
}

</style>
</head>
<body>
  <div class="back">
  <div class="sidenav">
    <span class="navbtn" href=""><i class="fa fa-navicon"></i></span>

    <div class="items">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="choropleth_map.html">Unemployement</a></li>
          <li><a href="heatmap.html">Wages</a></li>
          <li><a href="sunburst.html">Population</a></li>
          <li><a href="pie_chart.html">Reason</a></li>
          <li><a href="clustered_stacked_bar_chart.html">Disease</a></li>
          <li><a href="bubble_chart.html">Immigration</a></li>
        </ul>
    </div>
</div>

<script>
  const btn = document.querySelector(".navbtn");
    btn.addEventListener("click",()=>{
    document.body.classList.toggle("active")
    })
</script>

  <div class="Title">
    <div class="info">
      <h2>Choropleth Map</h2>
      <h1>Unemployment Rate of 2023 in India State</h1>

      <p>
        Unemployment poses a persistent and complex challenge in India, exhibiting variations across different regions and industries. Several factors contribute to 
        the prevalence of unemployment, underscoring the multifaceted nature of the issue. Among the prominent causes are population growth and an educational 
        mismatch.
      </p>

      <p>
        India's large and continuously expanding population intensifies competition within the job market. The sheer volume of job seekers creates a demanding 
        environment where securing employment becomes increasingly competitive. Unfortunately, the pace of job creation doesn't consistently align with the growth 
        of the labour force, resulting in a significant segment of the Indian population grappling with unemployment.
      </p>

      <p>
        The educational landscape further complicates the employment scenario. Many individuals in India do not pursue education beyond the primary level, leading to 
        a deficiency in knowledge reserves. Moreover, this educational gap is compounded by a prevalent mismatch between the skills possessed by job applicants and 
        those sought by employers. This mismatch becomes particularly pronounced among the youth, where insufficient educational attainment and a disparity in skill 
        sets contribute substantially to the escalating rates of unemployment.
      </p>

      <p>
        The inability to secure stable employment has profound consequences, precipitating economic hardships that result in a substantial decline in living standards 
        for individuals in India. This challenging situation makes it increasingly difficult for them to meet fundamental needs such as housing, healthcare, and 
        education. The nexus between unemployment and a decline in living standards underscores the pervasive impact on the overall well-being of the affected population.
      </p>

      <p>
        As the unemployment rate rises, a noteworthy phenomenon emerges which is the large-scale migration of individuals seeking improved employment opportunities. 
        Faced with limited prospects within India, people are compelled to explore better job markets in countries with more developed economies. 
      </p>

      <p>
        The migration of individuals from India seeking better employment opportunities not only underscores the interdependence of the global economy but also 
        accentuates the urgent need for India to formulate a comprehensive strategy to address unemployment. The following data visualization of India's unemployment 
        rate across different regions serves as a valuable tool for analysis, observation, and understanding of prevailing trends. This data-driven approach empowers 
        policymakers and stakeholders to derive insights and formulate targeted solutions, fostering the cultivation of a more resilient and prosperous India. By 
        leveraging the insights gleaned from such visualizations, India can tailor interventions to address regional disparities, enhance skill development, and create 
        an environment conducive to sustainable economic growth, ultimately mitigating the challenges posed by unemployment.
      </p>
    </div>
  </div>

  <div class="map-row">
      <div class="left-clmn">
      <div id="map"></div>
    </div>
  <div id="right-clmn">
    <div id="inner"></div>
    <div class="selectState">You are selected :
      <div id="maptext"></div>
    </div>
    <label for="percentageToCheck">Filter by Percentage:</label>
    <input type="number" id="percentageToCheck" placeholder="Enter Percentage">
    <button onclick="applyFilter()" class="searchb">Filter Data</button>

    <div id="filter-buttons">
    <button onclick="applyFilter(0, 10)" class="btn">0-10%</button>
    <button onclick="applyFilter(11, 20)" class="btn">11-20%</button>
    <button onclick="applyFilter(21, 40)" class="btn">21% above</button>
    <button onclick="resetFilter()" class="btn">Reset</button>
  </div>
    
  <div id="filteredData"></div>
  </div>
    
</div></div>

  <script>
    //let margin = {top: 10, right: 20, bottom: 10, left: 450};
    let margin = {top: 0, right: 0, bottom: 0, left: 0};

    let width = 925 - margin.left - margin.right;
    let height = 650 - margin.top - margin.bottom;
    
    let svg = d3.select("#map").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      //.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      //.attr("transform", "translate(0,0)");

          
    // map background
    svg.append("rect")
      .attr("width",width)
      .attr("height",height)
      .style("fill","green")
      .style("opacity", 0); //Background best practice
        
    let div = d3.select("body").append("div")	
      .attr("class", "tooltip")				
      .style("opacity", 0);
    
    let activeState = null;
    let clickedClass = "clicked";

    Promise.all([
      d3.json("india-states.json"),
      d3.csv("unemployment.csv")
    ]).then(function(data){
      let geoJsonData = data[0];
      let languageData = data[1];
      let projection = d3.geoMercator();
      projection.fitHeight(height-100,geoJsonData);
      let pathGenerator = d3.geoPath().projection(projection);
      
      <!-- Append map of India -->
      let india = svg.append('g');     
      india.selectAll('path')
        .data(geoJsonData.features)
        .enter()
        .append('path')
          .attr('d', pathGenerator)
          .attr("transform", "translate(50,50)")
          .style("fill", function(d) {
            if(d.State == "Kerala") {
              return "red";
            }
            return "back";
          })
          .style("stroke", "black")
          .on("click", function(d) {
            // Remove the initial translate transform from the Indian map
            india.selectAll('path')
            .attr("transform", "translate(0,0)")

            // Define a new zoom level (e.g., 2 for double zoom)
            const newZoomLevel = 2;
            
            // Calculate the new transform based on the clicked position
            const [x, y] = d3.mouse(this);
            const scale = newZoomLevel;
            const translate = [width / 2 - scale * x, height / 2 - scale * y];
            const transform = d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale);
            
            // Apply the new zoom transform
            svg.transition().duration(750)
            .call(zoom.transform, transform);

            /***************************************/


            // Remove active class from previously active state
           if (activeState !== null) {
            d3.select(activeState).classed("active-state", false);
          }

          d3.selectAll('.dynamic-text').remove();

          const textContent = `${d.State}: ${d.Unemployment_Percentage_in_2023}%`;
          const [x2, y2] = projection(d3.geoCentroid(d));

          
          d3.select("#maptext").html(textContent); 

          d3.select(this).classed("active-state", true);
            activeState = this;

          })
          .on("mouseover", function(d) {
            div.style("opacity", .9);		
            div.html("<b><span class='state-text'>" + d.State + "</span></b><br><br>" 
            + d.Unemployment_Percentage_in_2023 + "%")
            
            .style("left", (d3.event.pageX) + "px")		
            .style("top", (d3.event.pageY - 28) + "px");
            
            var originalFillColor = d3.select(this).style("fill");

            d3.select(this) // Select the hovered element
            .style("fill", "#F8C471"); // Change fill color to light yellow
            
            d3.select(".state-text")
            .style("font-size", "16px");

            // On mouseout, revert fill color to original
            d3.select(this)
          .on("mouseout", function(d) {		
            div.style("opacity", 0);
      
            d3.select(this)
            .style("fill", originalFillColor);
          });

          })					
          .on("mouseout", function(d) {		
            div.style("opacity", 0).style("fill", function(d) {
            if(d.State == "Kerala") {
              return "red";
            }
            return "back";
          })
          d3.select("#tooltip").remove()
          ;	
            
          });
      
      console.log("Bout to go off");

      /**************************************************/
      // add the active for map 
      
      document.getElementById("map").addEventListener("click", function() {
      document.getElementById("maptext").classList.add("active");
      });


      /**************************************************/
      
      let colorScale = d3.scaleLinear()
        .domain([0, 5])
        .range(['#FFFFFF', '#E9967A']);
        
      /**************************************************/

      india.selectAll('path')
        .data(languageData)
        .style("fill", function(d) {
          let Unemployment_Percentage_in_2023 = d.Unemployment_Percentage_in_2023;
          
          return colorScale(Unemployment_Percentage_in_2023);
          //let team = d.team;
          /*if(Unemployment_Percentage_in_2023 >= 10) {
            return orangeScale(Unemployment_Percentage_in_2023);
          }
          return greenScale(Unemployment_Percentage_in_2023);
        });*/

            //return greenScale(Unemployment_Percentage_in_2023);
          });
              
      
      console.log("Went off");
                                  
    }) //End of Promise

    
    const zoom = d3.zoom()
            .scaleExtent([1, 5])
            .on("zoom", () => {
              svg.selectAll('g').attr('transform', d3.event.transform);
            });

        svg.call(zoom);

    /**************************************************/

    let colorScale = d3.scaleLinear()
        .domain([0, 5])
        .range(['#FFFFFF', '#E9967A']);

    let width2 = 380;
    let height2 = 110;
    let svg2 = d3.select("#inner").append("svg")
      .attr("width", width2 + margin.left + margin.right)
      .attr("height", height2 + margin.top + margin.bottom)
      .attr("transform", "translate(0,0)")
      .append("g");

      // Create a legend group
      let legend = svg2.append('g')
        .attr('class', 'legend')
        .attr('transform', 'translate(10, 10)'); // Adjust position as needed

      let blk_legend = svg2.append('g')
        .attr('class', 'blegend')
        .attr('transform', 'translate(10, 10)');

      // Define gradient
      let gradient = legend.append('defs')
        .append('linearGradient')
        .attr('id', 'colorGradient')
        .attr('x1', '0%')
        .attr('y1', '0%')
        .attr('x2', '100%')
        .attr('y2', '0%');

      gradient.append('stop')
        .attr('offset', '0%')
        .attr('style', 'stop-color:' + colorScale(1));

      gradient.append('stop')
        .attr('offset', '100%')
        .attr('style', 'stop-color:' + colorScale(10));

      // Create color bar rectangle
      legend.append('rect')
        .attr('width', 180) // Adjust the width of the legend
        .attr('height', 20) // Adjust the height of the legend
        .style('fill', 'url(#colorGradient)')
        .style('stroke', 'black');

      // Add text for lower range
      let lowerRangeText = legend.append('text')
        .attr('x', -90) // Adjust the x position to position the text
        .attr('y', 15) // Adjust the y position to position the text
        .text('Lower Range')
        .style('font-size', '15px');

      // Add text for higher range
      let higherRangeText = legend.append('text')
        .attr('x', 190) // Adjust the x position to position the text
        .attr('y', 15) // Adjust the y position to position the text
        .text('Higher Range')
        .style('font-size', '15px');

      // Create color bar rectangle
      blk_legend.append('rect')
        .attr('width', 100) // Adjust the width of the legend
        .attr('height', 20) // Adjust the height of the legend
        //.style('fill', 'url(#colorGradient)')
        .style('fill', 'black')
        .style('stroke', 'black');

      // Add text for lower range
      let blkText = blk_legend.append('text')
        .attr('x', 120) // Adjust the x position to position the text
        .attr('y', 15) // Adjust the y position to position the text
        .text('Undifined data')
        .style('font-size', '15px');


      /**************************************/
      // filter button

      function applyFilter(minRange, maxRange) {
      d3.csv("unemployment.csv").then(function(data) {
        let filteredData;

        if (minRange !== undefined && maxRange !== undefined) {
            // Filter by range
            filteredData = data.filter(function(d) {
                let unemploymentPercentage = parseFloat(d.Unemployment_Percentage_in_2023);
                return unemploymentPercentage >= minRange && unemploymentPercentage <= maxRange;
            });
        } else {
            // Filter by input value
            let filterValue = parseFloat(document.getElementById("percentageToCheck").value);
            filteredData = data.filter(function(d) {
                return parseFloat(d.Unemployment_Percentage_in_2023) > filterValue;
            });
        }

        let colorScale = d3.scaleLinear()
        .domain([0, 5])
        .range(['#FFFFFF', '#E9967A']);

        // Update map colors
        d3.selectAll('path')
            .style("fill", function(d) {
                let stateData = filteredData.find(entry => entry.State === d.State);
                if (stateData) {
                    return colorScale(parseFloat(stateData.Unemployment_Percentage_in_2023));
                } else {
                    return "gray"; // Default color for states not in filtered data
                }
            });

        // Update table
        let tableHTML = "<table><tr><th>State</th><th>Unemployment Percentage</th></tr>";
        filteredData.forEach(function(d) {
            tableHTML += "<tr><td>" + d.State + "</td><td>" + d.Unemployment_Percentage_in_2023 + "%</td></tr>";
        });
        tableHTML += "</table>";

        document.getElementById("filteredData").innerHTML = tableHTML;
    });
}

    function resetFilter() {
      d3.selectAll('path')
        .classed('filtered', false)
        .style("fill", function(d) {
          return colorScale(d.Unemployment_Percentage_in_2023);
        });

        document.getElementById("filteredData").innerHTML = ""; // This line removes the content of the 'filteredData' div

    }








  </script>
  
  </div>
</body>
</html>
