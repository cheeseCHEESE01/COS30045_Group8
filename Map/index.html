<html>
<header>
<title>Rice vs Roti</title>
</header>
<head>
<meta charset="utf-8">
<script src="https://d3js.org/d3.v5.min.js"></script>
<style>

div.tooltip {	
    position: absolute;			
    text-align: center;			
    width: 140px;					
    height: 50px;					
    padding: 2px;				
    font: 12px sans-serif;		
    background: lightblue;	
    border: 0px;			
    pointer-events: none;			
}

</style>
</head>
<body>
  <div id = "postContents"; style="text-align:center;"> 
  
  <script>
    let margin = {top: 10, right: 20, bottom: 10, left: 450};
    let width = 1200 - margin.left - margin.right;
    let height = 700 - margin.top - margin.bottom;
    
    let svg = d3.select("body").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");
          
    // map background
    svg.append("rect")
      .attr("width",width)
      .attr("height",height)
      .style("fill","green")
      .style("opacity", 1); //Background best practice
        
    let div = d3.select("body").append("div")	
      .attr("class", "tooltip")				
      .style("opacity", 0);
    
    
    Promise.all([
      d3.json("india-states.json"),
      d3.csv("unemployment.csv")
    ]).then(function(data){
      let geoJsonData = data[0];
      let languageData = data[1];
      let projection = d3.geoMercator();
      projection.fitHeight(height-100,geoJsonData);
      let pathGenerator = d3.geoPath().projection(projection);
      
      <!-- Append map of India -->
      let india = svg.append('g');     
      india.selectAll('path')
        .data(geoJsonData.features)
        .enter()
        .append('path')
          .attr('d', pathGenerator)
          .style("fill", function(d) {
            if(d.State == "Kerala") {
              return "red";
            }
            return "back";
          })
          .style("stroke", "black")

          // the detail box show
          .on("mouseover", function(d) {
            div.style("opacity", .9);		
            div.html(d.State + "</br>" 
            + d.Unemployment_Percentage_in_2022 + "%")
            
            .style("left", (d3.event.pageX) + "px")		
            .style("top", (d3.event.pageY - 28) + "px");
          })					
          .on("mouseout", function(d) {		
            div.style("opacity", 0);	
          });
      
      console.log("Bout to go off");
      
      let colorScale = d3.scaleLinear()
        .domain([0, 5])
        .range(['#FFFFFF', '#E9967A']);
        
      /*
      let orangeScale = d3.scaleLinear()
        .domain([6, 10])
        .range(['#FFFFFF','#FF7F50']);
        
      let greenScale = d3.scaleLinear()
        .domain([11, 20])
        .range(['#FFFFFF','#E9967A']);
      */
      
      india.selectAll('path')
        .data(languageData)
        .style("fill", function(d) {
          let Unemployment_Percentage_in_2022 = d.Unemployment_Percentage_in_2022;
          
          return colorScale(Unemployment_Percentage_in_2022);
          //let team = d.team;
          /*if(Unemployment_Percentage_in_2022 >= 10) {
            return orangeScale(Unemployment_Percentage_in_2022);
          }
          return greenScale(Unemployment_Percentage_in_2022);
        });*/

            //return greenScale(Unemployment_Percentage_in_2022);
          });
              
      
      console.log("Went off");
                                  
    }) //End of Promise

    const zoom = d3.zoom()
            .scaleExtent([1, 5])
            .on("zoom", () => {
                svg.attr("transform", d3.event.transform);
            });

        svg.call(zoom);

  </script>
  
  </div>
</body>
</html>
